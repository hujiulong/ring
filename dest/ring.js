var Ring=new function(){function e(e){n(e,"fonts/Script_MT_Bold_Regular.json","models/9-1.js",t)}function n(e,n,t,o){var i,r=new THREE.FontLoader,a=new THREE.JSONLoader;r.load(n,function(n){i=n,a.load(t,function(n,t){o(e,i,n)})})}function t(e,n,t){T=a(e,n),x=i(t)}function o(){w=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),w.position.set(0,0,2e3),m=new THREE.TrackballControls(w,h),m.rotateSpeed=2,m.noZoom=!1,m.zoomSpeed=1.2,m.staticMoving=!0,p=new THREE.Scene,light=new THREE.DirectionalLight(16777215),light.position.set(0,100,200),p.add(light),light=new THREE.DirectionalLight(16777215),light.position.set(0,-100,-200),p.add(light),R=new THREE.WebGLRenderer({antialias:!0}),R.setPixelRatio(window.devicePixelRatio),R.setClearColor(16777215),R.setSize(window.innerWidth,window.innerHeight),h=document.getElementById("container"),h.appendChild(R.domElement),u=new Stats,u.domElement.style.position="absolute",u.domElement.style.top="0px",u.domElement.style.zIndex=100,h.appendChild(u.domElement),window.addEventListener("resize",E,!1)}function i(e){function n(e,n,t){return e.distanceToPoint(t)>0&&n.distanceToPoint(t)>0}console.log(e);var t,o=new THREE.Vector3,i=[],r=[],a=[],s=[],l=(new THREE.Matrix4).makeRotationX(-Math.PI/2).multiply((new THREE.Matrix4).makeScale(50,50,50));e.applyMatrix(l),e.verticesNeedUpdate=!0,e.computeBoundingBox(),t=(e.boundingBox.max.x-e.boundingBox.min.x)/2,o.set(0,0,t+e.boundingBox.min.z);var E=(T.width/2-7)/(t+T.depth/2),d=(new THREE.Vector3).crossVectors(new THREE.Vector3(0,0,1).applyAxisAngle(new THREE.Vector3(0,1,0),E).normalize(),new THREE.Vector3(0,1,1).applyAxisAngle(new THREE.Vector3(0,1,0),E).normalize()),g=(new THREE.Vector3).crossVectors(new THREE.Vector3(0,0,1).applyAxisAngle(new THREE.Vector3(0,1,0),-E).normalize(),new THREE.Vector3(0,1,1).applyAxisAngle(new THREE.Vector3(0,1,0),-E).normalize()),h=new THREE.Plane;h.setFromNormalAndCoplanarPoint(d.normalize(),o);var u=new THREE.Plane;u.setFromNormalAndCoplanarPoint(g.normalize().negate(),o);for(var w=0;w<e.faces.length;w++){var m=e.faces[w],R=e.vertices[m.a],v=e.vertices[m.b],f=e.vertices[m.c],y=[R,v,f],b=[0,0,0],B=[],M=[];n(h,u,R)&&(b[0]=1),n(h,u,v)&&(b[1]=1),n(h,u,f)&&(b[2]=1);for(var z=0;z<b.length;z++)b[z]?M.push(y[z]):B.push(y[z]);if(0==M.length)i.push(R,v,f),r.push(new THREE.Face3(i.length-1,i.length-2,i.length-3));else if(1==M.length){var L,P,V=new THREE.Line3(M[0],B[0]),A=new THREE.Line3(M[0],B[1]),F=1,S=1;void 0!=(L=h.intersectLine(V))?F=1:(L=u.intersectLine(V),F=2),void 0!=(P=h.intersectLine(A))?S=1:(P=u.intersectLine(A),S=2),i.push(B[0],B[1],L,P),r.push(new THREE.Face3(i.length-1,i.length-3,i.length-4)),r.push(new THREE.Face3(i.length-2,i.length-3,i.length-4)),r.push(new THREE.Face3(i.length-1,i.length-2,i.length-4)),1==F?a.push(i.length-2):s.push(i.length-2),1==S?a.push(i.length-1):s.push(i.length-1)}else if(2==M.length){var L,P,V=new THREE.Line3(B[0],M[0]),A=new THREE.Line3(B[0],M[1]),F=1,S=1;void 0!=(L=h.intersectLine(V))?F=1:(L=u.intersectLine(V),F=2),void 0!=(P=h.intersectLine(A))?S=1:(P=u.intersectLine(A),S=2),i.push(B[0],L,P),r.push(new THREE.Face3(i.length-1,i.length-2,i.length-3)),1==F?a.push(i.length-2):s.push(i.length-2),1==S?a.push(i.length-1):s.push(i.length-1)}}for(var w=2;w<a.length;w++)r.push(new THREE.Face3(a[0],a[w],a[w-1]));for(var w=2;w<s.length;w++)r.push(new THREE.Face3(s[0],s[w],s[w-1]));var C=new THREE.Geometry;C.vertices=i,C.faces=r,C.computeFaceNormals(),x=new THREE.Mesh(C,H),p.add(x),T=c(o,t,T),T.position.y=-70,T.position.x+=5,p.add(T)}function r(e){return e>="A"&&e<="Z"||"p"==e||"s"==e||"1"==e}function a(e,n){for(var t,o=0,i=0,a=0;a<e.length;a++)r(e[a])||a==e.length-1?(i&&(i=0,t=l(t,e.substring(o,a),n)),t=l(t,e[a],n)):i||(i=1,o=a);return t.geometry.computeBoundingBox(),t.width=t.geometry.boundingBox.max.x-t.geometry.boundingBox.min.x,t.height=t.geometry.boundingBox.max.y-t.geometry.boundingBox.min.y,t.depth=t.geometry.boundingBox.max.z-t.geometry.boundingBox.min.z,t}function s(e,n){return new THREE.TextGeometry(e,{size:158,height:70,curveSegments:4,font:n,weight:"bold",style:"normal",bevelEnabled:!0,bevelThickness:2,bevelSize:1})}function l(e,n,t){if(void 0===e)return new THREE.Mesh(s(n,t),H);e.geometry.computeBoundingBox();var o=e.geometry.clone(),i=s(n,t);o.computeBoundingBox(),i.computeBoundingBox();var r=o.boundingBox.max.x-o.boundingBox.min.x,a=i.boundingBox.max.x-o.boundingBox.min.x,l=i.boundingBox.max.y-o.boundingBox.min.y,c=!1,E=new THREE.Vector3(r,0,0);do{for(var d=E.clone().add(new THREE.Vector3(a/2,l/2,0)),g=0;g<i.vertices.length;g++)if(!(i.vertices[g].z!=d.z||i.vertices[g].x>=a/2)){var h=i.vertices[g].clone(),u=h.sub(new THREE.Vector3(a/2,l/2,0)),w=new THREE.Raycaster(d,u.clone().normalize()),m=w.intersectObject(e);if(m.length>0&&m[0].distance<u.length()){c=!0,o.merge(i,(new THREE.Matrix4).setPosition(E));break}}E.x-=3}while(!c);return new THREE.Mesh(o,H)}function c(e,n,t){var o=(new THREE.Matrix4).setPosition(new THREE.Vector3(-t.width/2,0,0));t.geometry.applyMatrix(o);for(var i=n+t.depth/2,r=2*i*Math.PI,a=0;a<t.geometry.vertices.length;a++){var s=t.geometry.vertices[a],l=n-s.z,c=s.x,E=c/r*Math.PI*2;t.geometry.vertices[a].set(l*Math.sin(E),s.y,l*Math.cos(E)).add(e)}return t.geometry.verticesNeedUpdate=!0,t}function E(){w.aspect=window.innerWidth/window.innerHeight,w.updateProjectionMatrix(),R.setSize(window.innerWidth,window.innerHeight)}function d(){requestAnimationFrame(d),g()}function g(){u.update(),m.update(),R.render(p,w)}(new Date).getTime();Detector.webgl||Detector.addGetWebGLMessage();var h,u,w,m,p,R,T,x,H=(new THREE.MeshPhongMaterial({color:16764482}),new THREE.MeshPhongMaterial({color:16764482,specular:3355443,combine:THREE.MixOperation,shininess:40,reflectivity:.55,side:THREE.DoubleSide}));new THREE.Projector;return o(),d(),{build:function(n){return n.length>13?void alert("文字太长"):void e(n)}}};