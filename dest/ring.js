var Ring=new function(){function e(){c(0,0,2e3),m=new THREE.Scene,light=new THREE.DirectionalLight(16777215),light.position.set(0,100,200),m.add(light),light=new THREE.DirectionalLight(16777215),light.position.set(0,-100,-200),m.add(light),h=new THREE.WebGLRenderer({antialias:!0}),h.setClearColor(16777215),h.setSize(window.innerWidth,window.innerHeight),g=document.getElementById("container"),g.appendChild(h.domElement),s=new Stats,s.domElement.style.position="absolute",s.domElement.style.top="0px",s.domElement.style.zIndex=100,g.appendChild(s.domElement),window.addEventListener("resize",E,!1)}function n(e){var n=new THREE.FontLoader;n.load("fonts/Script_MT_Bold_Regular.json",function(n){T=n,t(e)})}function o(e){return e>="A"&&e<="Z"||"p"==e||"s"==e||e>="0"&&e<="9"}function t(e){console.log(e);for(var n,t=0,i=0,E=0;E<e.length;E++)o(e[E])||E==e.length-1?(i&&(i=0,n=r(n,e.substring(t,E))),n=r(n,e[E])):i||(i=1,t=E);var a=new THREE.Vector3(0,0,(-1)),l=new THREE.Vector3(0,1,0);Math.PI/6;n.geometry.computeBoundingBox(),n.width=n.geometry.boundingBox.max.x-n.geometry.boundingBox.min.x,n.height=n.geometry.boundingBox.max.y-n.geometry.boundingBox.min.y,console.log(n.width),n.position.set(-n.width/2+80,-n.height/2,470),m.add(n);var c=960,g=n.width/(2*c*Math.PI)*Math.PI*2;H.set(a,l,g).modify(n.geometry),n.geometry.computeBoundingBox(),console.log(n.geometry.boundingBox.max.x-n.geometry.boundingBox.min.x);var s=new THREE.BoundingBoxHelper(n,16711680);s.update(),s.geometry.computeBoundingBox(),console.log(s.geometry);var u=(new THREE.Box3).setFromObject(n),w=s.position.clone().add(new THREE.Vector3(0,0,(u.max.z-u.min.z)/2)),h=(new THREE.ArrowHelper(new THREE.Vector3(0,0,(-1)),w,200,16711680),d(50,n.height,c,g)),T=new THREE.BoundingBoxHelper(h,16711680);T.update(),T.geometry.computeBoundingBox();var R=(new THREE.Box3).setFromObject(h),p=T.position.clone().add(new THREE.Vector3(0,0,(R.max.z-R.min.z)/2));new THREE.ArrowHelper(new THREE.Vector3(0,0,(-1)),p,200,16711680);n.position.add(p.sub(w)),s.update();var B=new ThreeBSP(h),v=new ThreeBSP(s),b=B.subtract(v).toGeometry(),y=new THREE.Mesh(b,x);m.add(y)}function i(e){return new THREE.TextGeometry(e,{size:158,height:50,curveSegments:4,font:T,weight:"bold",style:"normal",bevelEnabled:!0,bevelThickness:2,bevelSize:1})}function r(e,n){if(void 0===e)return new THREE.Mesh(i(n),x);e.geometry.computeBoundingBox();var o=e.geometry.clone(),t=i(n);o.computeBoundingBox(),t.computeBoundingBox();var r=o.boundingBox.max.x-o.boundingBox.min.x,d=t.boundingBox.max.x-o.boundingBox.min.x,E=t.boundingBox.max.y-o.boundingBox.min.y;console.log(E);var a=!1,l=new THREE.Vector3(r,0,0);do{for(var c=l.clone().add(new THREE.Vector3(d/2,E/2,0)),g=0;g<t.vertices.length;g++)if(!(t.vertices[g].z!=c.z||t.vertices[g].x>=d/2)){var s=t.vertices[g].clone(),u=s.sub(new THREE.Vector3(d/2,E/2,0)),w=new THREE.Raycaster(c,u.clone().normalize()),m=w.intersectObject(e);if(m.length>0&&m[0].distance<u.length()){a=!0,o.merge(t,(new THREE.Matrix4).setPosition(l));break}}l.x-=3}while(!a);return new THREE.Mesh(o,x)}function d(e,n,o,t){for(var i=new THREE.EllipseCurve(0,0,430,430,0,2*Math.PI,(!1),0),r=[],d=0;d<=1;d+=.01)r.push(new THREE.Vector3(i.getPointAt(d).x,0,i.getPointAt(d).y));var E=new THREE.CatmullRomCurve3(r);E.closed=!0;var a={extrudePath:E,steps:300},l=new THREE.Shape;l.moveTo(0,0),l.lineTo(n,0),l.lineTo(n,e),l.lineTo(0,e);var c=new THREE.ExtrudeGeometry(l,a),g=new THREE.Mesh(c,x);return g}function E(){u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),h.setSize(window.innerWidth,window.innerHeight)}function a(){requestAnimationFrame(a),l()}function l(){s.update(),w.update(),h.render(m,u)}function c(e,n,o){u=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),u.position.set(e,n,o),w=new THREE.TrackballControls(u),w.rotateSpeed=2,w.noZoom=!1,w.zoomSpeed=1.2,w.staticMoving=!0}Detector.webgl||Detector.addGetWebGLMessage();var g,s,u,w,m,h,T,x=(new THREE.MeshPhongMaterial({color:16764482}),new THREE.MeshPhongMaterial({color:16764482,specular:3355443,combine:THREE.MixOperation,shininess:40,reflectivity:.55})),H=(new THREE.Vector2,new THREE.Projector,new THREE.BendModifier);new THREE.Vector3(0,0,(-1)),new THREE.Vector3(0,1,0),Math.PI/6;return e(),a(),{build:function(e){return e.length>7?void alert("文字太长"):void n(e)}}};